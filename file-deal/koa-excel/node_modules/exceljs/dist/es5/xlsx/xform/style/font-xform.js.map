{"version":3,"sources":["../../../../../lib/xlsx/xform/style/font-xform.js"],"names":["ColorXform","require","BooleanXform","IntegerXform","StringXform","UnderlineXform","_","utils","BaseXform","FontXform","module","exports","options","OPTIONS","map","b","prop","xform","tag","attr","i","u","charset","color","condense","extend","family","outline","vertAlign","scheme","shadow","strike","sz","fontNameTag","tagName","inherits","render","xmlStream","model","openNode","each","defn","closeNode","parseOpen","node","parser","name","parseText","text","parseClose","item","undefined"],"mappings":"AAAA;;AAEA,IAAIA,aAAaC,QAAQ,eAAR,CAAjB;AACA,IAAIC,eAAeD,QAAQ,yBAAR,CAAnB;AACA,IAAIE,eAAeF,QAAQ,yBAAR,CAAnB;AACA,IAAIG,cAAcH,QAAQ,wBAAR,CAAlB;AACA,IAAII,iBAAiBJ,QAAQ,mBAAR,CAArB;;AAEA,IAAIK,IAAIL,QAAQ,2BAAR,CAAR;AACA,IAAIM,QAAQN,QAAQ,sBAAR,CAAZ;AACA,IAAIO,YAAYP,QAAQ,eAAR,CAAhB;;AAEA;AACA,IAAIQ,YAAYC,OAAOC,OAAP,GAAiB,UAASC,OAAT,EAAkB;AACjD,OAAKA,OAAL,GAAeA,WAAWH,UAAUI,OAApC;;AAEA,OAAKC,GAAL,GAAW;AACTC,OAAG,EAAEC,MAAM,MAAR,EAAgBC,OAAO,IAAIf,YAAJ,CAAiB,EAACgB,KAAK,GAAN,EAAWC,MAAM,KAAjB,EAAjB,CAAvB,EADM;AAETC,OAAG,EAAEJ,MAAM,QAAR,EAAkBC,OAAO,IAAIf,YAAJ,CAAiB,EAACgB,KAAK,GAAN,EAAWC,MAAM,KAAjB,EAAjB,CAAzB,EAFM;AAGTE,OAAG,EAAEL,MAAM,WAAR,EAAqBC,OAAO,IAAIZ,cAAJ,EAA5B,EAHM;AAITiB,aAAS,EAAEN,MAAM,SAAR,EAAmBC,OAAO,IAAId,YAAJ,CAAiB,EAACe,KAAK,SAAN,EAAiBC,MAAM,KAAvB,EAAjB,CAA1B,EAJA;AAKTI,WAAO,EAAEP,MAAM,OAAR,EAAiBC,OAAO,IAAIjB,UAAJ,EAAxB,EALE;AAMTwB,cAAU,EAAER,MAAM,UAAR,EAAoBC,OAAO,IAAIf,YAAJ,CAAiB,EAACgB,KAAK,UAAN,EAAkBC,MAAM,KAAxB,EAAjB,CAA3B,EAND;AAOTM,YAAQ,EAAET,MAAM,QAAR,EAAkBC,OAAO,IAAIf,YAAJ,CAAiB,EAACgB,KAAK,QAAN,EAAgBC,MAAM,KAAtB,EAAjB,CAAzB,EAPC;AAQTO,YAAQ,EAAEV,MAAM,QAAR,EAAkBC,OAAO,IAAId,YAAJ,CAAiB,EAACe,KAAK,QAAN,EAAgBC,MAAM,KAAtB,EAAjB,CAAzB,EARC;AASTQ,aAAS,EAAEX,MAAM,SAAR,EAAmBC,OAAO,IAAIf,YAAJ,CAAiB,EAACgB,KAAK,SAAN,EAAiBC,MAAM,KAAvB,EAAjB,CAA1B,EATA;AAUTS,eAAW,EAAEZ,MAAM,WAAR,EAAqBC,OAAO,IAAIb,WAAJ,CAAgB,EAAEc,KAAK,WAAP,EAAoBC,MAAM,KAA1B,EAAhB,CAA5B,EAVF;AAWTU,YAAQ,EAAEb,MAAM,QAAR,EAAkBC,OAAO,IAAIb,WAAJ,CAAgB,EAACc,KAAK,QAAN,EAAgBC,MAAM,KAAtB,EAAhB,CAAzB,EAXC;AAYTW,YAAQ,EAAEd,MAAM,QAAR,EAAkBC,OAAO,IAAIf,YAAJ,CAAiB,EAACgB,KAAK,QAAN,EAAgBC,MAAM,KAAtB,EAAjB,CAAzB,EAZC;AAaTY,YAAQ,EAAEf,MAAM,QAAR,EAAkBC,OAAO,IAAIf,YAAJ,CAAiB,EAACgB,KAAK,QAAN,EAAgBC,MAAM,KAAtB,EAAjB,CAAzB,EAbC;AAcTa,QAAI,EAAEhB,MAAM,MAAR,EAAgBC,OAAO,IAAId,YAAJ,CAAiB,EAACe,KAAK,IAAN,EAAYC,MAAM,KAAlB,EAAjB,CAAvB;AAdK,GAAX;AAgBA,OAAKL,GAAL,CAAS,KAAKF,OAAL,CAAaqB,WAAtB,IAAqC,EAAEjB,MAAM,MAAR,EAAgBC,OAAO,IAAIb,WAAJ,CAAgB,EAACc,KAAK,KAAKN,OAAL,CAAaqB,WAAnB,EAAgCd,MAAM,KAAtC,EAAhB,CAAvB,EAArC;AACD,CApBD;;AAsBAV,UAAUI,OAAV,GAAoB;AAClBqB,WAAS,MADS;AAElBD,eAAa;AAFK,CAApB;;AAKA1B,MAAM4B,QAAN,CAAe1B,SAAf,EAA0BD,SAA1B,EAAqC;;AAEnC,MAAIU,GAAJ,GAAU;AAAE,WAAO,KAAKN,OAAL,CAAasB,OAApB;AAA8B,GAFP;;AAInCE,UAAQ,gBAASC,SAAT,EAAoBC,KAApB,EAA2B;AACjC,QAAIxB,MAAM,KAAKA,GAAf;;AAEAuB,cAAUE,QAAV,CAAmB,KAAK3B,OAAL,CAAasB,OAAhC;AACA5B,MAAEkC,IAAF,CAAO,KAAK1B,GAAZ,EAAiB,UAAS2B,IAAT,EAAevB,GAAf,EAAoB;AACnCJ,UAAII,GAAJ,EAASD,KAAT,CAAemB,MAAf,CAAsBC,SAAtB,EAAiCC,MAAMG,KAAKzB,IAAX,CAAjC;AACD,KAFD;AAGAqB,cAAUK,SAAV;AACD,GAZkC;;AAcnCC,aAAW,mBAASC,IAAT,EAAe;AACxB,QAAI,KAAKC,MAAT,EAAiB;AACf,WAAKA,MAAL,CAAYF,SAAZ,CAAsBC,IAAtB;AACA,aAAO,IAAP;AACD;AACD,QAAI,KAAK9B,GAAL,CAAS8B,KAAKE,IAAd,CAAJ,EAAyB;AACvB,WAAKD,MAAL,GAAc,KAAK/B,GAAL,CAAS8B,KAAKE,IAAd,EAAoB7B,KAAlC;AACA,aAAO,KAAK4B,MAAL,CAAYF,SAAZ,CAAsBC,IAAtB,CAAP;AACD;AACD,YAAQA,KAAKE,IAAb;AACE,WAAK,KAAKlC,OAAL,CAAasB,OAAlB;AACE,aAAKI,KAAL,GAAa,EAAb;AACA,eAAO,IAAP;AACF;AACE,eAAO,KAAP;AALJ;AAOD,GA9BkC;AA+BnCS,aAAW,mBAASC,IAAT,EAAe;AACxB,QAAI,KAAKH,MAAT,EAAiB;AACf,WAAKA,MAAL,CAAYE,SAAZ,CAAsBC,IAAtB;AACD;AACF,GAnCkC;AAoCnCC,cAAY,oBAASH,IAAT,EAAe;AACzB,QAAI,KAAKD,MAAL,IAAe,CAAC,KAAKA,MAAL,CAAYI,UAAZ,CAAuBH,IAAvB,CAApB,EAAkD;AAChD,UAAII,OAAO,KAAKpC,GAAL,CAASgC,IAAT,CAAX;AACA,UAAI,KAAKD,MAAL,CAAYP,KAAhB,EAAuB;AACrB,aAAKA,KAAL,CAAWY,KAAKlC,IAAhB,IAAwB,KAAK6B,MAAL,CAAYP,KAApC;AACD;AACD,WAAKO,MAAL,GAAcM,SAAd;AACA,aAAO,IAAP;AACD;AACD,YAAQL,IAAR;AACE,WAAK,KAAKlC,OAAL,CAAasB,OAAlB;AACE,eAAO,KAAP;AACF;AACE,eAAO,IAAP;AAJJ;AAMD;AAnDkC,CAArC","file":"font-xform.js","sourcesContent":["'use strict';\n\nvar ColorXform = require('./color-xform');\nvar BooleanXform = require('../simple/boolean-xform');\nvar IntegerXform = require('../simple/integer-xform');\nvar StringXform = require('../simple/string-xform');\nvar UnderlineXform = require('./underline-xform');\n\nvar _ = require('../../../utils/under-dash');\nvar utils = require('../../../utils/utils');\nvar BaseXform = require('../base-xform');\n\n// Font encapsulates translation from font model to xlsx\nvar FontXform = module.exports = function(options) {\n  this.options = options || FontXform.OPTIONS;\n\n  this.map = {\n    b: { prop: 'bold', xform: new BooleanXform({tag: 'b', attr: 'val'}) },\n    i: { prop: 'italic', xform: new BooleanXform({tag: 'i', attr: 'val'}) },\n    u: { prop: 'underline', xform: new UnderlineXform() },\n    charset: { prop: 'charset', xform: new IntegerXform({tag: 'charset', attr: 'val'}) },\n    color: { prop: 'color', xform: new ColorXform() },\n    condense: { prop: 'condense', xform: new BooleanXform({tag: 'condense', attr: 'val'}) },\n    extend: { prop: 'extend', xform: new BooleanXform({tag: 'extend', attr: 'val'}) },\n    family: { prop: 'family', xform: new IntegerXform({tag: 'family', attr: 'val'}) },\n    outline: { prop: 'outline', xform: new BooleanXform({tag: 'outline', attr: 'val'}) },\n    vertAlign: { prop: 'vertAlign', xform: new StringXform({ tag: 'vertAlign', attr: 'val' }) },\n    scheme: { prop: 'scheme', xform: new StringXform({tag: 'scheme', attr: 'val'}) },\n    shadow: { prop: 'shadow', xform: new BooleanXform({tag: 'shadow', attr: 'val'}) },\n    strike: { prop: 'strike', xform: new BooleanXform({tag: 'strike', attr: 'val'}) },\n    sz: { prop: 'size', xform: new IntegerXform({tag: 'sz', attr: 'val'}) }\n  };\n  this.map[this.options.fontNameTag] = { prop: 'name', xform: new StringXform({tag: this.options.fontNameTag, attr: 'val'}) };\n};\n\nFontXform.OPTIONS = {\n  tagName: 'font',\n  fontNameTag: 'name'\n};\n\nutils.inherits(FontXform, BaseXform, {\n\n  get tag() { return this.options.tagName; },\n\n  render: function(xmlStream, model) {\n    var map = this.map;\n\n    xmlStream.openNode(this.options.tagName);\n    _.each(this.map, function(defn, tag) {\n      map[tag].xform.render(xmlStream, model[defn.prop]);\n    });\n    xmlStream.closeNode();\n  },\n\n  parseOpen: function(node) {\n    if (this.parser) {\n      this.parser.parseOpen(node);\n      return true;\n    }\n    if (this.map[node.name]) {\n      this.parser = this.map[node.name].xform;\n      return this.parser.parseOpen(node);\n    }\n    switch (node.name) {\n      case this.options.tagName:\n        this.model = {};\n        return true;\n      default:\n        return false;\n    }\n  },\n  parseText: function(text) {\n    if (this.parser) {\n      this.parser.parseText(text);\n    }\n  },\n  parseClose: function(name) {\n    if (this.parser && !this.parser.parseClose(name)) {\n      var item = this.map[name];\n      if (this.parser.model) {\n        this.model[item.prop] = this.parser.model;\n      }\n      this.parser = undefined;\n      return true;\n    }\n    switch (name) {\n      case this.options.tagName:\n        return false;\n      default:\n        return true;\n    }\n  }\n});\n"]}